{
    "id": "654779e7-41f7-46c9-b7ac-8dd909439de8",
    "name": "PrepareMachinesForDeployment",
    "friendlyName": "KPMG TTG | Prepare Machines for Deployment",
    "description": "Copies and configures the necessary files to allow for typical Octopus and DSC deployments",
    "category": "Deploy",
    "visibility": [
        "Release"
    ],
    "author": "KPMG LLP",
    "version": {
        "Major": 1,
        "Minor": 0,
        "Patch": 0
    },
    "groups": [
        {
            "name": "configuration",
            "displayName": "Configuration",
            "isExpanded": true
        }
    ],
    "inputs": [
        {
            "name": "MachineNames",
            "type": "multiLine",
            "label": "Machines",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Provide a comma separated list of machine names to prepare."
        },
        {
            "name": "WinRmAdminUserName",
            "type": "string",
            "label": "Admin Login",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Administrator login for the target machines."
        },
        {
            "name": "WinRmAdminPass",
            "type": "string",
            "label": "Password",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Administrator password for the target machines. <br>It can accept variable defined in Build/Release definitions as '$(passwordVariable)'. <br>You may mark variable type as 'secret' to secure it."
        },
        {
            "name": "WinRmProtocol",
            "type": "radio",
            "label": "Protocol",
            "required": false,
            "defaultValue": "",
            "options": {
                "Http": "HTTP",
                "Https": "HTTPS"
            },
            "helpMarkDown": "Select the protocol to use for the WinRM connection with the machine(s). Default is HTTPS."
        },
        {
            "name": "WinRmSkipCertificateTests",
            "type": "boolean",
            "label": "Skip Certificate Tests",
            "defaultValue": "true",
            "visibleRule": "WinRmProtocol = Https",
            "required": false,
            "helpMarkDown": "Select the option to skip validating the authenticity of the machine's certificate by a trusted certification authority. The parameter is required for the WinRM HTTPS protocol."
        },
        {
            "name": "ParallelDeploymentThrottle",
            "type": "pickList",
            "label": "Parallel Deployment Throttle",
            "defaultValue": "5",
            "required": true,
            "options": {
                "1": "1",
                "2": "2",
                "3": "3",
                "4": "4",
                "5": "5"
            },
            "helpMarkDown": "The maximum number of machines to deploy to simultaneously."
        },
        {
            "name": "PrepareCalamari",
            "type": "boolean",
            "label": "TTG Calamari",
            "defaultValue": "true",
            "groupName": "configuration",
            "required": false,
            "helpMarkDown": "Select this option to prepare TTG Octopus Calamari on the target server."
        },
        {
            "name": "PrepareCommonDsc",
            "type": "boolean",
            "label": "Common DSC Modules",
            "defaultValue": "true",
            "groupName": "configuration",
            "required": false,
            "helpMarkDown": "Select this option to prepare common DSC modules on the target server."
        }
    ],
    "minimumAgentVersion": "1.104.0",
    "instanceNameFormat": "Prepare Machines for Deployment",
    "execution": {
        "PowerShell": {
            "target": "$(currentDirectory)\\PrepareMachinesForDeployment.ps1",
            "argumentFormat": "",
            "workingDirectory": "$(currentDirectory)"
        }
    }
}
