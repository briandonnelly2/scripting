{
    "id": "cc87654b-f41d-45c7-ae89-425fc9f93821",
    "name": "PrepareWorkflowEnvironment-App",
    "friendlyName": "KPMG TTG | Workflow Environment Preparation - App",
    "description": "Prepares app servers in a Workflow environment",
    "category": "Deploy",
    "visibility": [
        "Release"
    ],
    "author": "KPMG LLP",
    "version": {
        "Major": 1,
        "Minor": 0,
        "Patch": 0
    },
    "groups": [
        {
            "name": "settings",
            "displayName": "Settings",
            "isExpanded": true
        }
    ],
    "inputs": [
        // ---------- WinRM
        {
            "name": "MachineNames",
            "type": "multiLine",
            "label": "Machines",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Provide a comma separated list of machine names to prepare."
        },
        {
            "name": "WinRmAdminUserName",
            "type": "string",
            "label": "Admin Login",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Administrator login for the target machines."
        },
        {
            "name": "WinRmAdminPass",
            "type": "string",
            "label": "Password",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Administrator password for the target machines. <br>It can accept variable defined in Build/Release definitions as '$(passwordVariable)'. <br>You may mark variable type as 'secret' to secure it."
        },
        {
            "name": "WinRmProtocol",
            "type": "radio",
            "label": "Protocol",
            "required": false,
            "defaultValue": "",
            "options": {
                "Http": "HTTP",
                "Https": "HTTPS"
            },
            "helpMarkDown": "Select the protocol to use for the WinRM connection with the machine(s). Default is HTTPS."
        },
        {
            "name": "WinRmSkipCertificateTests",
            "type": "boolean",
            "label": "Skip Certificate Tests",
            "defaultValue": "true",
            "visibleRule": "WinRmProtocol = Https",
            "required": false,
            "helpMarkDown": "Select the option to skip validating the authenticity of the machine's certificate by a trusted certification authority. The parameter is required for the WinRM HTTPS protocol."
        },
        {
            "name": "ParallelDeploymentThrottle",
            "type": "radio",
            "label": "Parallel Deployment Throttle",
            "defaultValue": "5",
            "required": true,
            "options": {
                "1": "1",
                "2": "2",
                "3": "3",
                "4": "4",
                "5": "5"
            },
            "helpMarkDown": "The maximum number of machines to deploy to simultaneously."
        },
        {
            "name": "Environment",
            "type": "string",
            "label": "Environment",
            "defaultValue": "",
            "groupName": "settings",
            "required": true,
            "options": {
                "Dev": "Dev",
                "Test": "Test",
                "Stg": "Staging",
                "Live": "Live",
                "Live PA": "Live PA"
            },
            "helpMarkDown": "The environment being prepared."
        },
        {
            "name": "DeploymentPath",
            "type": "string",
            "label": "Deployment Path",
            "defaultValue": "C:\\Deployments",
            "groupName": "settings",
            "required": true,
            "helpMarkDown": "The root path applications are deployed to."
        }
    ],
    "minimumAgentVersion": "1.104.0",
    "instanceNameFormat": "Workfow App Server Preparation for $(Environment) Environment",
    "execution": {
        "PowerShell": {
            "target": "$(currentDirectory)\\PrepareWorkflowEnvironment-App.ps1",
            "argumentFormat": "",
            "workingDirectory": "$(currentDirectory)"
        }
    }
}
